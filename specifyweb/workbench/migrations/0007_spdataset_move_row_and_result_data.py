# Generated by Django 2.2.10 on 2021-07-20 15:34

import json
from django.db import migrations

def copy_spdataset_data(apps, schema_editor):
    Spdataset = apps.get_model('workbench', 'Spdataset')

    for dataset in Spdataset.objects.all():
        for i, row in enumerate(dataset.data):
            dataset.rows.create(rownumber=i, data=row)

        if dataset.rowresults_old is not None:
            results = json.loads(dataset.rowresults_old)
            for i, result in enumerate(results):
                dataset.rowresults.create(rownumber=i, result=json.dumps(result))


class Migration(migrations.Migration):

    dependencies = [
        ('workbench', '0006_add_spdataset_row_and_result_tables'),
    ]

    operations = [
        migrations.RunPython(copy_spdataset_data)
    ]
